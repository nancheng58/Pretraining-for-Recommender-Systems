Namespace(adam_beta1=0.9, adam_beta2=0.999, attention_probs_dropout_prob=0.5, batch_size=128, ckp=150, cuda_condition=True, data_dir='./data/', data_file='./data/ml-1m.txt', data_name='ml-1m', do_eval=False, epochs=200, gpu_id='0', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, item_size=3418, log_file='output/Finetune_sample-ml-1m-150.txt', log_freq=1, lr=0.001, mask_id=3417, max_seq_length=50, model_name='Finetune_sample', no_cuda=False, num_attention_heads=1, num_hidden_layers=2, output_dir='output/', sample_file='./data/ml-1m_sample.txt', seed=42, weight_decay=0.0)
Total Parameters: 338688
Load Checkpoint From output/ml-1m-epochs-150.pt!
{'epoch': 0, 'rec_avg_loss': '0.9498', 'rec_cur_loss': '0.8977'}
{'Epoch': 0, 'HIT@5': '0.2382', 'NDCG@5': '0.1528', 'HIT@10': '0.3887', 'NDCG@10': '0.2012', 'HIT@20': '0.5844', 'NDCG@20': '0.2506', 'MRR@5': '0.1689', 'MRR@10': '0.1689', 'MRR@20': '0.1689'}
Validation score increased.  Saving model ...
{'epoch': 1, 'rec_avg_loss': '0.8085', 'rec_cur_loss': '0.7290'}
{'Epoch': 1, 'HIT@5': '0.2952', 'NDCG@5': '0.1878', 'HIT@10': '0.4606', 'NDCG@10': '0.2411', 'HIT@20': '0.6525', 'NDCG@20': '0.2894', 'MRR@5': '0.1968', 'MRR@10': '0.1968', 'MRR@20': '0.1968'}
Validation score increased.  Saving model ...
{'epoch': 2, 'rec_avg_loss': '0.7622', 'rec_cur_loss': '0.8143'}
{'Epoch': 2, 'HIT@5': '0.3197', 'NDCG@5': '0.2041', 'HIT@10': '0.4879', 'NDCG@10': '0.2582', 'HIT@20': '0.6737', 'NDCG@20': '0.3052', 'MRR@5': '0.2098', 'MRR@10': '0.2098', 'MRR@20': '0.2098'}
Validation score increased.  Saving model ...
{'epoch': 3, 'rec_avg_loss': '0.7342', 'rec_cur_loss': '0.7480'}
{'Epoch': 3, 'HIT@5': '0.3291', 'NDCG@5': '0.2081', 'HIT@10': '0.4969', 'NDCG@10': '0.2620', 'HIT@20': '0.6730', 'NDCG@20': '0.3066', 'MRR@5': '0.2113', 'MRR@10': '0.2113', 'MRR@20': '0.2113'}
Validation score increased.  Saving model ...
{'epoch': 4, 'rec_avg_loss': '0.7165', 'rec_cur_loss': '0.7170'}
{'Epoch': 4, 'HIT@5': '0.3432', 'NDCG@5': '0.2191', 'HIT@10': '0.5141', 'NDCG@10': '0.2739', 'HIT@20': '0.6884', 'NDCG@20': '0.3181', 'MRR@5': '0.2212', 'MRR@10': '0.2212', 'MRR@20': '0.2212'}
Validation score increased.  Saving model ...
{'epoch': 5, 'rec_avg_loss': '0.7009', 'rec_cur_loss': '0.6562'}
{'Epoch': 5, 'HIT@5': '0.3515', 'NDCG@5': '0.2263', 'HIT@10': '0.5280', 'NDCG@10': '0.2830', 'HIT@20': '0.7002', 'NDCG@20': '0.3267', 'MRR@5': '0.2283', 'MRR@10': '0.2283', 'MRR@20': '0.2283'}
Validation score increased.  Saving model ...
{'epoch': 6, 'rec_avg_loss': '0.6921', 'rec_cur_loss': '0.7043'}
{'Epoch': 6, 'HIT@5': '0.3664', 'NDCG@5': '0.2353', 'HIT@10': '0.5399', 'NDCG@10': '0.2912', 'HIT@20': '0.7075', 'NDCG@20': '0.3337', 'MRR@5': '0.2347', 'MRR@10': '0.2347', 'MRR@20': '0.2347'}
Validation score increased.  Saving model ...
{'epoch': 7, 'rec_avg_loss': '0.6883', 'rec_cur_loss': '0.6715'}
{'Epoch': 7, 'HIT@5': '0.3624', 'NDCG@5': '0.2326', 'HIT@10': '0.5377', 'NDCG@10': '0.2892', 'HIT@20': '0.7073', 'NDCG@20': '0.3322', 'MRR@5': '0.2328', 'MRR@10': '0.2328', 'MRR@20': '0.2328'}
EarlyStopping counter: 1 out of 10
{'epoch': 8, 'rec_avg_loss': '0.6820', 'rec_cur_loss': '0.7224'}
{'Epoch': 8, 'HIT@5': '0.3694', 'NDCG@5': '0.2398', 'HIT@10': '0.5515', 'NDCG@10': '0.2986', 'HIT@20': '0.7141', 'NDCG@20': '0.3398', 'MRR@5': '0.2403', 'MRR@10': '0.2403', 'MRR@20': '0.2403'}
Validation score increased.  Saving model ...
{'epoch': 9, 'rec_avg_loss': '0.6721', 'rec_cur_loss': '0.6728'}
{'Epoch': 9, 'HIT@5': '0.3854', 'NDCG@5': '0.2484', 'HIT@10': '0.5644', 'NDCG@10': '0.3062', 'HIT@20': '0.7225', 'NDCG@20': '0.3463', 'MRR@5': '0.2455', 'MRR@10': '0.2455', 'MRR@20': '0.2455'}
Validation score increased.  Saving model ...
{'epoch': 10, 'rec_avg_loss': '0.6703', 'rec_cur_loss': '0.6350'}
{'Epoch': 10, 'HIT@5': '0.3816', 'NDCG@5': '0.2445', 'HIT@10': '0.5601', 'NDCG@10': '0.3021', 'HIT@20': '0.7189', 'NDCG@20': '0.3424', 'MRR@5': '0.2417', 'MRR@10': '0.2417', 'MRR@20': '0.2417'}
EarlyStopping counter: 1 out of 10
{'epoch': 11, 'rec_avg_loss': '0.6674', 'rec_cur_loss': '0.6944'}
{'Epoch': 11, 'HIT@5': '0.3975', 'NDCG@5': '0.2577', 'HIT@10': '0.5795', 'NDCG@10': '0.3165', 'HIT@20': '0.7298', 'NDCG@20': '0.3547', 'MRR@5': '0.2537', 'MRR@10': '0.2537', 'MRR@20': '0.2537'}
Validation score increased.  Saving model ...
{'epoch': 12, 'rec_avg_loss': '0.6611', 'rec_cur_loss': '0.6115'}
{'Epoch': 12, 'HIT@5': '0.3907', 'NDCG@5': '0.2534', 'HIT@10': '0.5745', 'NDCG@10': '0.3129', 'HIT@20': '0.7293', 'NDCG@20': '0.3522', 'MRR@5': '0.2509', 'MRR@10': '0.2509', 'MRR@20': '0.2509'}
EarlyStopping counter: 1 out of 10
{'epoch': 13, 'rec_avg_loss': '0.6601', 'rec_cur_loss': '0.6830'}
{'Epoch': 13, 'HIT@5': '0.3972', 'NDCG@5': '0.2579', 'HIT@10': '0.5823', 'NDCG@10': '0.3178', 'HIT@20': '0.7293', 'NDCG@20': '0.3551', 'MRR@5': '0.2544', 'MRR@10': '0.2544', 'MRR@20': '0.2544'}
Validation score increased.  Saving model ...
{'epoch': 14, 'rec_avg_loss': '0.6559', 'rec_cur_loss': '0.6654'}
{'Epoch': 14, 'HIT@5': '0.4026', 'NDCG@5': '0.2607', 'HIT@10': '0.5813', 'NDCG@10': '0.3185', 'HIT@20': '0.7311', 'NDCG@20': '0.3565', 'MRR@5': '0.2556', 'MRR@10': '0.2556', 'MRR@20': '0.2556'}
Validation score increased.  Saving model ...
{'epoch': 15, 'rec_avg_loss': '0.6513', 'rec_cur_loss': '0.6191'}
{'Epoch': 15, 'HIT@5': '0.4038', 'NDCG@5': '0.2602', 'HIT@10': '0.5798', 'NDCG@10': '0.3171', 'HIT@20': '0.7275', 'NDCG@20': '0.3548', 'MRR@5': '0.2545', 'MRR@10': '0.2545', 'MRR@20': '0.2545'}
EarlyStopping counter: 1 out of 10
{'epoch': 16, 'rec_avg_loss': '0.6492', 'rec_cur_loss': '0.6532'}
{'Epoch': 16, 'HIT@5': '0.4078', 'NDCG@5': '0.2647', 'HIT@10': '0.5897', 'NDCG@10': '0.3235', 'HIT@20': '0.7354', 'NDCG@20': '0.3605', 'MRR@5': '0.2592', 'MRR@10': '0.2592', 'MRR@20': '0.2592'}
Validation score increased.  Saving model ...
{'epoch': 17, 'rec_avg_loss': '0.6475', 'rec_cur_loss': '0.6480'}
{'Epoch': 17, 'HIT@5': '0.4058', 'NDCG@5': '0.2628', 'HIT@10': '0.5844', 'NDCG@10': '0.3205', 'HIT@20': '0.7308', 'NDCG@20': '0.3577', 'MRR@5': '0.2570', 'MRR@10': '0.2570', 'MRR@20': '0.2570'}
EarlyStopping counter: 1 out of 10
{'epoch': 18, 'rec_avg_loss': '0.6437', 'rec_cur_loss': '0.5204'}
{'Epoch': 18, 'HIT@5': '0.4086', 'NDCG@5': '0.2657', 'HIT@10': '0.5892', 'NDCG@10': '0.3243', 'HIT@20': '0.7354', 'NDCG@20': '0.3614', 'MRR@5': '0.2604', 'MRR@10': '0.2604', 'MRR@20': '0.2604'}
Validation score increased.  Saving model ...
{'epoch': 19, 'rec_avg_loss': '0.6427', 'rec_cur_loss': '0.6543'}
{'Epoch': 19, 'HIT@5': '0.4139', 'NDCG@5': '0.2696', 'HIT@10': '0.5911', 'NDCG@10': '0.3270', 'HIT@20': '0.7381', 'NDCG@20': '0.3645', 'MRR@5': '0.2634', 'MRR@10': '0.2634', 'MRR@20': '0.2634'}
Validation score increased.  Saving model ...
{'epoch': 20, 'rec_avg_loss': '0.6390', 'rec_cur_loss': '0.5927'}
{'Epoch': 20, 'HIT@5': '0.4175', 'NDCG@5': '0.2732', 'HIT@10': '0.5894', 'NDCG@10': '0.3289', 'HIT@20': '0.7397', 'NDCG@20': '0.3671', 'MRR@5': '0.2663', 'MRR@10': '0.2663', 'MRR@20': '0.2663'}
Validation score increased.  Saving model ...
{'epoch': 21, 'rec_avg_loss': '0.6379', 'rec_cur_loss': '0.6043'}
{'Epoch': 21, 'HIT@5': '0.4209', 'NDCG@5': '0.2735', 'HIT@10': '0.5942', 'NDCG@10': '0.3296', 'HIT@20': '0.7414', 'NDCG@20': '0.3671', 'MRR@5': '0.2656', 'MRR@10': '0.2656', 'MRR@20': '0.2656'}
EarlyStopping counter: 1 out of 10
{'epoch': 22, 'rec_avg_loss': '0.6358', 'rec_cur_loss': '0.7102'}
{'Epoch': 22, 'HIT@5': '0.4123', 'NDCG@5': '0.2677', 'HIT@10': '0.5861', 'NDCG@10': '0.3240', 'HIT@20': '0.7344', 'NDCG@20': '0.3618', 'MRR@5': '0.2611', 'MRR@10': '0.2611', 'MRR@20': '0.2611'}
EarlyStopping counter: 2 out of 10
{'epoch': 23, 'rec_avg_loss': '0.6327', 'rec_cur_loss': '0.6021'}
{'Epoch': 23, 'HIT@5': '0.4161', 'NDCG@5': '0.2725', 'HIT@10': '0.5944', 'NDCG@10': '0.3302', 'HIT@20': '0.7404', 'NDCG@20': '0.3672', 'MRR@5': '0.2663', 'MRR@10': '0.2663', 'MRR@20': '0.2663'}
EarlyStopping counter: 3 out of 10
{'epoch': 24, 'rec_avg_loss': '0.6332', 'rec_cur_loss': '0.6351'}
{'Epoch': 24, 'HIT@5': '0.4230', 'NDCG@5': '0.2765', 'HIT@10': '0.5940', 'NDCG@10': '0.3321', 'HIT@20': '0.7392', 'NDCG@20': '0.3690', 'MRR@5': '0.2686', 'MRR@10': '0.2686', 'MRR@20': '0.2686'}
Validation score increased.  Saving model ...
{'epoch': 25, 'rec_avg_loss': '0.6319', 'rec_cur_loss': '0.6609'}
{'Epoch': 25, 'HIT@5': '0.4252', 'NDCG@5': '0.2779', 'HIT@10': '0.5965', 'NDCG@10': '0.3336', 'HIT@20': '0.7432', 'NDCG@20': '0.3709', 'MRR@5': '0.2699', 'MRR@10': '0.2699', 'MRR@20': '0.2699'}
Validation score increased.  Saving model ...
{'epoch': 26, 'rec_avg_loss': '0.6284', 'rec_cur_loss': '0.5813'}
{'Epoch': 26, 'HIT@5': '0.4325', 'NDCG@5': '0.2845', 'HIT@10': '0.6013', 'NDCG@10': '0.3391', 'HIT@20': '0.7455', 'NDCG@20': '0.3758', 'MRR@5': '0.2754', 'MRR@10': '0.2754', 'MRR@20': '0.2754'}
Validation score increased.  Saving model ...
{'epoch': 27, 'rec_avg_loss': '0.6260', 'rec_cur_loss': '0.5941'}
{'Epoch': 27, 'HIT@5': '0.4267', 'NDCG@5': '0.2807', 'HIT@10': '0.6000', 'NDCG@10': '0.3369', 'HIT@20': '0.7439', 'NDCG@20': '0.3735', 'MRR@5': '0.2729', 'MRR@10': '0.2729', 'MRR@20': '0.2729'}
EarlyStopping counter: 1 out of 10
{'epoch': 28, 'rec_avg_loss': '0.6240', 'rec_cur_loss': '0.5749'}
{'Epoch': 28, 'HIT@5': '0.4341', 'NDCG@5': '0.2834', 'HIT@10': '0.6022', 'NDCG@10': '0.3378', 'HIT@20': '0.7480', 'NDCG@20': '0.3748', 'MRR@5': '0.2733', 'MRR@10': '0.2733', 'MRR@20': '0.2733'}
EarlyStopping counter: 2 out of 10
{'epoch': 29, 'rec_avg_loss': '0.6208', 'rec_cur_loss': '0.6110'}
{'Epoch': 29, 'HIT@5': '0.4270', 'NDCG@5': '0.2818', 'HIT@10': '0.5988', 'NDCG@10': '0.3376', 'HIT@20': '0.7444', 'NDCG@20': '0.3747', 'MRR@5': '0.2744', 'MRR@10': '0.2744', 'MRR@20': '0.2744'}
EarlyStopping counter: 3 out of 10
{'epoch': 30, 'rec_avg_loss': '0.6227', 'rec_cur_loss': '0.6435'}
{'Epoch': 30, 'HIT@5': '0.4243', 'NDCG@5': '0.2797', 'HIT@10': '0.5965', 'NDCG@10': '0.3356', 'HIT@20': '0.7414', 'NDCG@20': '0.3724', 'MRR@5': '0.2723', 'MRR@10': '0.2723', 'MRR@20': '0.2723'}
EarlyStopping counter: 4 out of 10
{'epoch': 31, 'rec_avg_loss': '0.6233', 'rec_cur_loss': '0.6606'}
{'Epoch': 31, 'HIT@5': '0.4326', 'NDCG@5': '0.2853', 'HIT@10': '0.6081', 'NDCG@10': '0.3423', 'HIT@20': '0.7480', 'NDCG@20': '0.3778', 'MRR@5': '0.2770', 'MRR@10': '0.2770', 'MRR@20': '0.2770'}
Validation score increased.  Saving model ...
{'epoch': 32, 'rec_avg_loss': '0.6195', 'rec_cur_loss': '0.5502'}
{'Epoch': 32, 'HIT@5': '0.4359', 'NDCG@5': '0.2876', 'HIT@10': '0.6086', 'NDCG@10': '0.3436', 'HIT@20': '0.7505', 'NDCG@20': '0.3796', 'MRR@5': '0.2787', 'MRR@10': '0.2787', 'MRR@20': '0.2787'}
Validation score increased.  Saving model ...
{'epoch': 33, 'rec_avg_loss': '0.6182', 'rec_cur_loss': '0.6326'}
{'Epoch': 33, 'HIT@5': '0.4323', 'NDCG@5': '0.2851', 'HIT@10': '0.6060', 'NDCG@10': '0.3415', 'HIT@20': '0.7490', 'NDCG@20': '0.3779', 'MRR@5': '0.2768', 'MRR@10': '0.2768', 'MRR@20': '0.2768'}
EarlyStopping counter: 1 out of 10
{'epoch': 34, 'rec_avg_loss': '0.6172', 'rec_cur_loss': '0.6264'}
{'Epoch': 34, 'HIT@5': '0.4339', 'NDCG@5': '0.2862', 'HIT@10': '0.6051', 'NDCG@10': '0.3418', 'HIT@20': '0.7502', 'NDCG@20': '0.3787', 'MRR@5': '0.2774', 'MRR@10': '0.2774', 'MRR@20': '0.2774'}
EarlyStopping counter: 2 out of 10
{'epoch': 35, 'rec_avg_loss': '0.6145', 'rec_cur_loss': '0.6029'}
{'Epoch': 35, 'HIT@5': '0.4353', 'NDCG@5': '0.2860', 'HIT@10': '0.6065', 'NDCG@10': '0.3415', 'HIT@20': '0.7483', 'NDCG@20': '0.3776', 'MRR@5': '0.2765', 'MRR@10': '0.2765', 'MRR@20': '0.2765'}
EarlyStopping counter: 3 out of 10
{'epoch': 36, 'rec_avg_loss': '0.6139', 'rec_cur_loss': '0.5731'}
{'Epoch': 36, 'HIT@5': '0.4343', 'NDCG@5': '0.2850', 'HIT@10': '0.6036', 'NDCG@10': '0.3400', 'HIT@20': '0.7478', 'NDCG@20': '0.3766', 'MRR@5': '0.2756', 'MRR@10': '0.2756', 'MRR@20': '0.2756'}
EarlyStopping counter: 4 out of 10
{'epoch': 37, 'rec_avg_loss': '0.6157', 'rec_cur_loss': '0.6482'}
{'Epoch': 37, 'HIT@5': '0.4354', 'NDCG@5': '0.2860', 'HIT@10': '0.6084', 'NDCG@10': '0.3420', 'HIT@20': '0.7477', 'NDCG@20': '0.3774', 'MRR@5': '0.2765', 'MRR@10': '0.2765', 'MRR@20': '0.2765'}
EarlyStopping counter: 5 out of 10
{'epoch': 38, 'rec_avg_loss': '0.6090', 'rec_cur_loss': '0.5193'}
{'Epoch': 38, 'HIT@5': '0.4407', 'NDCG@5': '0.2883', 'HIT@10': '0.6108', 'NDCG@10': '0.3434', 'HIT@20': '0.7513', 'NDCG@20': '0.3792', 'MRR@5': '0.2775', 'MRR@10': '0.2775', 'MRR@20': '0.2775'}
EarlyStopping counter: 6 out of 10
{'epoch': 39, 'rec_avg_loss': '0.6115', 'rec_cur_loss': '0.5973'}
{'Epoch': 39, 'HIT@5': '0.4354', 'NDCG@5': '0.2858', 'HIT@10': '0.6061', 'NDCG@10': '0.3411', 'HIT@20': '0.7485', 'NDCG@20': '0.3774', 'MRR@5': '0.2762', 'MRR@10': '0.2762', 'MRR@20': '0.2762'}
EarlyStopping counter: 7 out of 10
{'epoch': 40, 'rec_avg_loss': '0.6087', 'rec_cur_loss': '0.5878'}
{'Epoch': 40, 'HIT@5': '0.4339', 'NDCG@5': '0.2839', 'HIT@10': '0.5988', 'NDCG@10': '0.3373', 'HIT@20': '0.7483', 'NDCG@20': '0.3754', 'MRR@5': '0.2739', 'MRR@10': '0.2739', 'MRR@20': '0.2739'}
EarlyStopping counter: 8 out of 10
{'epoch': 41, 'rec_avg_loss': '0.6077', 'rec_cur_loss': '0.5902'}
{'Epoch': 41, 'HIT@5': '0.4416', 'NDCG@5': '0.2895', 'HIT@10': '0.6056', 'NDCG@10': '0.3426', 'HIT@20': '0.7490', 'NDCG@20': '0.3790', 'MRR@5': '0.2781', 'MRR@10': '0.2781', 'MRR@20': '0.2781'}
EarlyStopping counter: 9 out of 10
{'epoch': 42, 'rec_avg_loss': '0.6072', 'rec_cur_loss': '0.6336'}
{'Epoch': 42, 'HIT@5': '0.4359', 'NDCG@5': '0.2855', 'HIT@10': '0.6041', 'NDCG@10': '0.3400', 'HIT@20': '0.7474', 'NDCG@20': '0.3765', 'MRR@5': '0.2755', 'MRR@10': '0.2755', 'MRR@20': '0.2755'}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Sample 99 results-------------------
{'Epoch': 0, 'HIT@5': '0.3959', 'NDCG@5': '0.2602', 'HIT@10': '0.5788', 'NDCG@10': '0.3195', 'HIT@20': '0.7260', 'NDCG@20': '0.3569', 'MRR@5': '0.2575', 'MRR@10': '0.2575', 'MRR@20': '0.2575'}
Finetune_sample-ml-1m-150
{'Epoch': 0, 'HIT@5': '0.3959', 'NDCG@5': '0.2602', 'HIT@10': '0.5788', 'NDCG@10': '0.3195', 'HIT@20': '0.7260', 'NDCG@20': '0.3569', 'MRR@5': '0.2575', 'MRR@10': '0.2575', 'MRR@20': '0.2575'}
