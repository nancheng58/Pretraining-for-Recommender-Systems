Namespace(adam_beta1=0.9, adam_beta2=0.999, attention_probs_dropout_prob=0.5, batch_size=256, ckp=60, cuda_condition=True, data_dir='./data/', data_file='./data/beauty.txt', data_name='beauty', do_eval=False, epochs=200, gpu_id='0', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, item_size=54544, log_file='output/Finetune_sample-beauty-60.txt', log_freq=1, lr=0.001, mask_id=54543, max_seq_length=50, model_name='Finetune_sample', no_cuda=False, num_attention_heads=2, num_hidden_layers=2, output_dir='output/', sample_file='./data/beauty_sample.txt', seed=42, weight_decay=0.0)
Total Parameters: 3610752
Load Checkpoint From output/beauty-epochs-60.pt!
{'epoch': 0, 'rec_avg_loss': '1.1219', 'rec_cur_loss': '1.0278'}
{'Epoch': 0, 'HIT@1': '0.0937', 'NDCG@1': '0.0937', 'HIT@5': '0.2825', 'NDCG@5': '0.1898', 'HIT@10': '0.4048', 'NDCG@10': '0.2292', 'MRR': '0.1955'}
Validation score increased.  Saving model ...
{'epoch': 1, 'rec_avg_loss': '0.9681', 'rec_cur_loss': '0.8999'}
{'Epoch': 1, 'HIT@1': '0.1102', 'NDCG@1': '0.1102', 'HIT@5': '0.3030', 'NDCG@5': '0.2090', 'HIT@10': '0.4236', 'NDCG@10': '0.2478', 'MRR': '0.2133'}
Validation score increased.  Saving model ...
{'epoch': 2, 'rec_avg_loss': '0.9273', 'rec_cur_loss': '0.7399'}
{'Epoch': 2, 'HIT@1': '0.1206', 'NDCG@1': '0.1206', 'HIT@5': '0.3145', 'NDCG@5': '0.2205', 'HIT@10': '0.4298', 'NDCG@10': '0.2576', 'MRR': '0.2238'}
Validation score increased.  Saving model ...
{'epoch': 3, 'rec_avg_loss': '0.9020', 'rec_cur_loss': '0.8871'}
{'Epoch': 3, 'HIT@1': '0.1247', 'NDCG@1': '0.1247', 'HIT@5': '0.3182', 'NDCG@5': '0.2246', 'HIT@10': '0.4346', 'NDCG@10': '0.2620', 'MRR': '0.2280'}
Validation score increased.  Saving model ...
{'epoch': 4, 'rec_avg_loss': '0.8811', 'rec_cur_loss': '0.8225'}
{'Epoch': 4, 'HIT@1': '0.1299', 'NDCG@1': '0.1299', 'HIT@5': '0.3232', 'NDCG@5': '0.2296', 'HIT@10': '0.4381', 'NDCG@10': '0.2666', 'MRR': '0.2327'}
Validation score increased.  Saving model ...
{'epoch': 5, 'rec_avg_loss': '0.8632', 'rec_cur_loss': '0.8819'}
{'Epoch': 5, 'HIT@1': '0.1334', 'NDCG@1': '0.1334', 'HIT@5': '0.3264', 'NDCG@5': '0.2331', 'HIT@10': '0.4391', 'NDCG@10': '0.2695', 'MRR': '0.2360'}
Validation score increased.  Saving model ...
{'epoch': 6, 'rec_avg_loss': '0.8529', 'rec_cur_loss': '0.9498'}
{'Epoch': 6, 'HIT@1': '0.1366', 'NDCG@1': '0.1366', 'HIT@5': '0.3303', 'NDCG@5': '0.2367', 'HIT@10': '0.4413', 'NDCG@10': '0.2725', 'MRR': '0.2392'}
Validation score increased.  Saving model ...
{'epoch': 7, 'rec_avg_loss': '0.8416', 'rec_cur_loss': '0.7735'}
{'Epoch': 7, 'HIT@1': '0.1389', 'NDCG@1': '0.1389', 'HIT@5': '0.3333', 'NDCG@5': '0.2396', 'HIT@10': '0.4443', 'NDCG@10': '0.2753', 'MRR': '0.2419'}
Validation score increased.  Saving model ...
{'epoch': 8, 'rec_avg_loss': '0.8295', 'rec_cur_loss': '0.8891'}
{'Epoch': 8, 'HIT@1': '0.1411', 'NDCG@1': '0.1411', 'HIT@5': '0.3345', 'NDCG@5': '0.2413', 'HIT@10': '0.4435', 'NDCG@10': '0.2764', 'MRR': '0.2436'}
Validation score increased.  Saving model ...
{'epoch': 9, 'rec_avg_loss': '0.8221', 'rec_cur_loss': '0.7726'}
{'Epoch': 9, 'HIT@1': '0.1386', 'NDCG@1': '0.1386', 'HIT@5': '0.3305', 'NDCG@5': '0.2380', 'HIT@10': '0.4396', 'NDCG@10': '0.2732', 'MRR': '0.2407'}
EarlyStopping counter: 1 out of 10
{'epoch': 10, 'rec_avg_loss': '0.8125', 'rec_cur_loss': '0.6323'}
{'Epoch': 10, 'HIT@1': '0.1413', 'NDCG@1': '0.1413', 'HIT@5': '0.3321', 'NDCG@5': '0.2403', 'HIT@10': '0.4397', 'NDCG@10': '0.2750', 'MRR': '0.2430'}
EarlyStopping counter: 2 out of 10
{'epoch': 11, 'rec_avg_loss': '0.8082', 'rec_cur_loss': '0.7437'}
{'Epoch': 11, 'HIT@1': '0.1431', 'NDCG@1': '0.1431', 'HIT@5': '0.3330', 'NDCG@5': '0.2417', 'HIT@10': '0.4415', 'NDCG@10': '0.2767', 'MRR': '0.2448'}
Validation score increased.  Saving model ...
{'epoch': 12, 'rec_avg_loss': '0.8008', 'rec_cur_loss': '0.8131'}
{'Epoch': 12, 'HIT@1': '0.1421', 'NDCG@1': '0.1421', 'HIT@5': '0.3340', 'NDCG@5': '0.2417', 'HIT@10': '0.4432', 'NDCG@10': '0.2768', 'MRR': '0.2443'}
EarlyStopping counter: 1 out of 10
{'epoch': 13, 'rec_avg_loss': '0.7944', 'rec_cur_loss': '0.7048'}
{'Epoch': 13, 'HIT@1': '0.1426', 'NDCG@1': '0.1426', 'HIT@5': '0.3302', 'NDCG@5': '0.2401', 'HIT@10': '0.4405', 'NDCG@10': '0.2756', 'MRR': '0.2437'}
EarlyStopping counter: 2 out of 10
{'epoch': 14, 'rec_avg_loss': '0.7919', 'rec_cur_loss': '0.8004'}
{'Epoch': 14, 'HIT@1': '0.1414', 'NDCG@1': '0.1414', 'HIT@5': '0.3312', 'NDCG@5': '0.2401', 'HIT@10': '0.4405', 'NDCG@10': '0.2753', 'MRR': '0.2433'}
EarlyStopping counter: 3 out of 10
{'epoch': 15, 'rec_avg_loss': '0.7875', 'rec_cur_loss': '0.8603'}
{'Epoch': 15, 'HIT@1': '0.1408', 'NDCG@1': '0.1408', 'HIT@5': '0.3310', 'NDCG@5': '0.2396', 'HIT@10': '0.4394', 'NDCG@10': '0.2745', 'MRR': '0.2425'}
EarlyStopping counter: 4 out of 10
{'epoch': 16, 'rec_avg_loss': '0.7813', 'rec_cur_loss': '0.7696'}
{'Epoch': 16, 'HIT@1': '0.1428', 'NDCG@1': '0.1428', 'HIT@5': '0.3310', 'NDCG@5': '0.2404', 'HIT@10': '0.4399', 'NDCG@10': '0.2756', 'MRR': '0.2438'}
EarlyStopping counter: 5 out of 10
{'epoch': 17, 'rec_avg_loss': '0.7759', 'rec_cur_loss': '0.7836'}
{'Epoch': 17, 'HIT@1': '0.1418', 'NDCG@1': '0.1418', 'HIT@5': '0.3299', 'NDCG@5': '0.2393', 'HIT@10': '0.4383', 'NDCG@10': '0.2742', 'MRR': '0.2426'}
EarlyStopping counter: 6 out of 10
{'epoch': 18, 'rec_avg_loss': '0.7713', 'rec_cur_loss': '0.6023'}
{'Epoch': 18, 'HIT@1': '0.1430', 'NDCG@1': '0.1430', 'HIT@5': '0.3304', 'NDCG@5': '0.2403', 'HIT@10': '0.4377', 'NDCG@10': '0.2749', 'MRR': '0.2436'}
EarlyStopping counter: 7 out of 10
{'epoch': 19, 'rec_avg_loss': '0.7665', 'rec_cur_loss': '0.7344'}
{'Epoch': 19, 'HIT@1': '0.1419', 'NDCG@1': '0.1419', 'HIT@5': '0.3297', 'NDCG@5': '0.2396', 'HIT@10': '0.4385', 'NDCG@10': '0.2747', 'MRR': '0.2432'}
EarlyStopping counter: 8 out of 10
{'epoch': 20, 'rec_avg_loss': '0.7629', 'rec_cur_loss': '0.7711'}
{'Epoch': 20, 'HIT@1': '0.1418', 'NDCG@1': '0.1418', 'HIT@5': '0.3300', 'NDCG@5': '0.2393', 'HIT@10': '0.4388', 'NDCG@10': '0.2744', 'MRR': '0.2426'}
EarlyStopping counter: 9 out of 10
{'epoch': 21, 'rec_avg_loss': '0.7595', 'rec_cur_loss': '0.7117'}
{'Epoch': 21, 'HIT@1': '0.1421', 'NDCG@1': '0.1421', 'HIT@5': '0.3296', 'NDCG@5': '0.2394', 'HIT@10': '0.4371', 'NDCG@10': '0.2740', 'MRR': '0.2427'}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Sample 99 results-------------------
{'Epoch': 0, 'HIT@1': '0.1133', 'NDCG@1': '0.1133', 'HIT@5': '0.2836', 'NDCG@5': '0.2012', 'HIT@10': '0.3860', 'NDCG@10': '0.2342', 'MRR': '0.2071'}
Finetune_sample-beauty-60
{'Epoch': 0, 'HIT@1': '0.1133', 'NDCG@1': '0.1133', 'HIT@5': '0.2836', 'NDCG@5': '0.2012', 'HIT@10': '0.3860', 'NDCG@10': '0.2342', 'MRR': '0.2071'}
